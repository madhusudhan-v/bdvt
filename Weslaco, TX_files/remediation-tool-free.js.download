var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,r)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,__spreadValues=(e,t)=>{for(var r in t||(t={}))__hasOwnProp.call(t,r)&&__defNormalProp(e,r,t[r]);if(__getOwnPropSymbols)for(var r of __getOwnPropSymbols(t))__propIsEnum.call(t,r)&&__defNormalProp(e,r,t[r]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__objRest=(e,t)=>{var r={};for(var n in e)__hasOwnProp.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&__getOwnPropSymbols)for(var n of __getOwnPropSymbols(e))t.indexOf(n)<0&&__propIsEnum.call(e,n)&&(r[n]=e[n]);return r},__async=(e,t,r)=>new Promise(((n,a)=>{var o=e=>{try{l(r.next(e))}catch(t){a(t)}},i=e=>{try{l(r.throw(e))}catch(t){a(t)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);l((r=r.apply(e,t)).next())}));!function(){"use strict";const e=["script","noscript","style","meta","link","path","circle","rect","ellipse","line","polygon","polyline","g"],t=["data-uw-ignore","data-uw-rm-ignore"],r=r=>!(r instanceof HTMLElement)||t.some((e=>r.hasAttribute(e)))||e.includes(r.nodeName.toLowerCase()),n=(e,t)=>"childList"===t?[].filter.call(e.addedNodes,(e=>!r(e))):"attributes"===t?r(e.target)?[]:[e.target]:[],a=e=>__async(this,null,(function*(){const t=yield fetch(e);return yield t.json()})),o={AriaEditorValues:[],BrokenLink:[],Contrast:[],EmptyControls:[],ExternalLink:[],Forms:[],Headings:[],Language:[],MissingAlts:[],Pdfs:[],VagueLinks:[]},i=UserWayWidgetApp.ContextHolder.config.remediation,l=UserWayWidgetApp.ContextHolder.config.tunings,s=UserWayWidgetApp.ContextHolder.config.services,c=UserWayWidgetApp.ContextHolder.config.imageAlt;function u(e){__spreadValues({},e)}const d=()=>__async(this,null,(function*(){if(null==i?void 0:i.consolidated){const e=yield a(i.consolidated);return e.MissingAlts.reverse(),void u(e)}u(o)}));var p=(e=>(e.Remediation="remediation",e.AriaEditor="aria-editor",e))(p||{}),m=(e=>(e.KeyboardNavEnabled="app-key-nav-enabled",e))(m||{});const g=(e,t)=>{const r=r=>{const{data:n}=r,{isUserWay:a,action:o,type:i}=n;a&&o===p.Remediation&&i===e&&t()};window.addEventListener("message",r);return()=>{window.removeEventListener("message",r)}},f=document.documentElement,E={attributes:!0,attributeFilter:["aria-label","alt"],childList:!0,subtree:!0},b=new Set,y=e=>{b.add(e)},A=new MutationObserver((e=>{const t=(e=>{const t=[];for(const r of e)t.push(...n(r,r.type));return t})(e);t.length&&b.forEach((e=>e(t)))})),h=()=>{const r=`${e.join(",")},${t.map((e=>`[${e}]`)).join(",")}`;return document.body.querySelectorAll(`*:not(${r})`)};const T="object"==typeof global&&global&&global.Object===Object&&global;var _="object"==typeof self&&self&&self.Object===Object&&self;const v=T||_||Function("return this")();const N=v.Symbol;var R=Object.prototype,O=R.hasOwnProperty,w=R.toString,L=N?N.toStringTag:void 0;var I=Object.prototype.toString;var S="[object Null]",x="[object Undefined]",D=N?N.toStringTag:void 0;function C(e){return null==e?void 0===e?x:S:D&&D in Object(e)?function(e){var t=O.call(e,L),r=e[L];try{e[L]=void 0;var n=!0}catch(o){}var a=w.call(e);return n&&(t?e[L]=r:delete e[L]),a}(e):function(e){return I.call(e)}(e)}var M="[object Symbol]";var k=/\s/;var P=/^\s+/;function U(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&k.test(e.charAt(t)););return t}(e)+1).replace(P,""):e}function W(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var B=NaN,j=/^[-+]0x[0-9a-f]+$/i,H=/^0b[01]+$/i,X=/^0o[0-7]+$/i,F=parseInt;function $(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&C(e)==M}(e))return B;if(W(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=W(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=U(e);var r=H.test(e);return r||X.test(e)?F(e.slice(2),r?2:8):j.test(e)?B:+e}const G=function(){return v.Date.now()};var K="Expected a function",V=Math.max,Z=Math.min;function q(e,t,r){var n,a,o,i,l,s,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(K);function m(t){var r=n,o=a;return n=a=void 0,c=t,i=e.apply(o,r)}function g(e){var r=e-s;return void 0===s||r>=t||r<0||d&&e-c>=o}function f(){var e=G();if(g(e))return E(e);l=setTimeout(f,function(e){var r=t-(e-s);return d?Z(r,o-(e-c)):r}(e))}function E(e){return l=void 0,p&&n?m(e):(n=a=void 0,i)}function b(){var e=G(),r=g(e);if(n=arguments,a=this,s=e,r){if(void 0===l)return function(e){return c=e,l=setTimeout(f,t),u?m(e):i}(s);if(d)return clearTimeout(l),l=setTimeout(f,t),m(s)}return void 0===l&&(l=setTimeout(f,t)),i}return t=$(t)||0,W(r)&&(u=!!r.leading,o=(d="maxWait"in r)?V($(r.maxWait)||0,t):o,p="trailing"in r?!!r.trailing:p),b.cancel=function(){void 0!==l&&clearTimeout(l),c=0,n=s=a=l=void 0},b.flush=function(){return void 0===l?i:E(G())},b}let z=!0;const Y=e=>{setTimeout((()=>{z=!1}),2e3);const t=function(e,t,r){var n=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return W(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),q(e,t,{leading:n,maxWait:t,trailing:a})}((t=>e(t)),300,{leading:!0,trailing:!0}),r=q((t=>e(t)),500,{maxWait:2e3,leading:!0,trailing:!0});return{run:e=>z?t(e):r(e)}},Q=e=>{if(["#text","#comment"].includes(e.nodeName))return!1;let t=e.getAttribute("aria-hidden"),r=e.getAttribute("hidden");return(e=>"none"===window.getComputedStyle(e).display)(e)||"true"===t||null!==r&&""!==r},J=["NOSCRIPT","SCRIPT","style"],ee=(e,t)=>{var r;for(let n=0;n<e.length;n++){let a=e[n];switch(a.nodeType){case Node.TEXT_NODE:t+=" "+(null==(r=a.textContent)?void 0:r.trim().replace(/(\n|\r\n)/g,""));break;case Node.ELEMENT_NODE:if(J.includes(a.tagName)||Q(a))break;const e=a.getAttribute("aria-hidden"),n=a.getAttribute("alt"),o=a.getAttribute("aria-label");if(!e||"false"===e){if(o){t+=" "+o;break}n&&(t+=n+" "),"IMG"!==a.tagName&&ee(a.childNodes,t)}}}return t},te=(e,t="")=>{let r=t;return(t=ee(e.childNodes,r)).replace(/\s+/g," ").trim()},re=e=>{let t=e.split(" "),r="";for(let n=0;n<t.length;n++){let e=document.getElementById(t[n]);e&&(r=" "+te(e,r))}return r},ne=(e,t=0)=>{let r=3735928559^t,n=1103547991^t;for(let a,o=0;o<e.length;o++)a=e.charCodeAt(o),r=Math.imul(r^a,2654435761),n=Math.imul(n^a,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&n)+(r>>>0)},ae=(e,t=!1)=>{var r;if("html"===e.nodeName.toLowerCase())return"/HTML";if("body"===e.nodeName.toLowerCase())return"/HTML/BODY";if("head"===e.nodeName.toLowerCase())return"/HTML/HEAD";let n=0;const a=null==(r=e.parentElement)?void 0:r.children;if(!a)return"";for(let o=0;o<a.length;o++){let r=a[o];if(r===e)return ae(e.parentElement,!0)+`/${e.tagName}[${n+1}]`+(t?"":oe(e));r.tagName===e.tagName&&n++}return""};function oe(e){const t={s:"src",h:"href"},r=e.innerText?ne(e.innerText):"";return Object.keys(t).reduce(((r,n)=>{const a=t[n],o=e.getAttribute(a)||"";return e.hasAttribute&&e.hasAttribute(a)&&""!==o?r+";"+n+":"+ne(o):r}),"|"+r)}const ie=new RegExp("^(data:)"),le=new RegExp("(.)(gif|jpe?g|tiff?|png|webp|bmp)","i"),se=e=>{if(ie.test(e))return e;e&&(e=e.replace(/^(http|https)(:\/\/)/,"").replace(/^(www\.)/,""));const t=e.match(le);return(null==t?void 0:t.index)&&(null==t?void 0:t.length)?e.substring(0,t.index+t[0].length):e.split("?")[0]},ce=e=>e?"LABEL"===e.tagName?e:ce(e.parentNode):null,ue=e=>{let t=ce(e.parentNode);if(t)return te(t,"");const r=e.getAttribute("aria-label"),n=e.getAttribute("aria-labelledby");if(r)return r;if(n)return re(n);if(e.id){let t=(e=>{const t=document.querySelectorAll("LABEL");for(let r=0;r<t.length;r++)if(t[r].htmlFor===e)return t[r];return null})(e.id);if(t)return te(t,"")}const a=e.getAttribute("title");if(a)return a;return te(e,"")||""};var de=(e=>(e.TABINDEX="tabindex",e.ROLE="role",e.TYPE="type",e.SRC="src",e.ARIA_LEVEL="ariaLevel",e.ORIGINAL_ALT="originalAlt",e))(de||{}),pe=(e=>(e.UNKNOWN="UNKNOWN",e.NOT_ALLOWED="NOT_ALLOWED",e.TEXT_NODE="TEXT_NODE",e.LANDMARK="LANDMARK",e.CONTROL="CONTROL",e.HEADING="HEADING",e.HAS_ALT_DESCRIPTION="HAS_ALT_DESCRIPTION",e.COMPOSED_TEXT_NODES="COMPOSED_TEXT_NODES",e.IFRAME="IFRAME",e.HIDDEN_FOR_READER="HIDDEN_FOR_READER",e))(pe||{}),me=(e=>(e.UNKNOWN="unknown",e.TEXT="text",e.IMAGE="image",e.HEADING="heading",e.FOOTER="footer",e.HEADER="header",e.NAV="nav",e.MAIN="main",e.FORM="form",e.LANDMARK="landmark",e.LINK="link",e.BUTTON="button",e.CHECKBOX="checkbox",e.RADIOBUTTON="radiobutton",e.INPUT="input",e.TEXTAREA="textarea",e.SELECT="select",e.ABBR="abbr",e.LIST_ITEM="list item",e))(me||{});const ge="accessibility-tree-observer",fe=["uw-sl","uwy","uw-s10-reading-guide","uw-s12-tooltip"],Ee=(e,t)=>t.ariaLabel?t.ariaLabel:t.ariaLabelledBy?re(t.ariaLabelledBy):te(e,""),be={},ye=UserWayWidgetApp.getLib("accessibility_tree_walker");let Ae,he=[],Te=1;const _e=(e,t)=>{var r;if(he=[],(e=>{const t=3===e.nodeType;return fe.some((t=>!!e.closest&&e.closest(`.${t}`)))||!t&&e.hasAttribute("data-uw-rm-ignore")})(e)&&!t)return null;const n={node:e,type:ye.identifyElementType(e)},a=(e=>{if(!e||!e.type)return{};const{node:t}=e;return[pe.UNKNOWN,pe.NOT_ALLOWED,pe.TEXT_NODE].includes(e.type)?{uwAtoId:t.uwAtoId}:{tagName:t.tagName,tabindex:t.getAttribute("tabindex")||"",role:t.getAttribute("role")||"",ariaLevel:t.getAttribute("aria-level")||"",ariaLabel:t.getAttribute("aria-label")||"",ariaLabelledBy:t.getAttribute("aria-labelledby")||"",type:t.getAttribute("type")||"",uwAtoId:t.uwAtoId}})(n);Ae=ye.identifyElementType(e);const o=Ae===pe.HIDDEN_FOR_READER;let i,l;switch(he=(e=>(e.tabindex&&he.push({name:de.TABINDEX,value:e.tabindex}),e.role&&he.push({name:de.ROLE,value:e.role}),e.type&&he.push({name:de.TYPE,value:e.type}),e.ariaLevel&&he.push({name:de.ARIA_LEVEL,value:e.ariaLevel}),he))(a),o&&((e,t)=>{const r=e.cloneNode(!0);r.removeAttribute("aria-hidden"),Ae=ye.identifyElementType(r),Ae!==pe.UNKNOWN||"IMG"!==t.tagName&&"img"!==t.role||(Ae=pe.HAS_ALT_DESCRIPTION)})(e,a),Ae){case pe.TEXT_NODE:i=(e=>{const t=me.TEXT;let r="";e.textContent&&(r=e.textContent.trim().replace(/(\n|\r\n)/g,"").replace(/\s+/g," "));const n={};return e.parentElement&&(n.parentXpath=ae(e.parentElement)),{semanticType:t,textToRead:r,additionalParams:n}})(e),be.parentXpath=null==(r=i.additionalParams)?void 0:r.parentXpath;break;case pe.COMPOSED_TEXT_NODES:i=((e,t)=>({semanticType:"LI"===t.tagName?me.LIST_ITEM:me.TEXT,textToRead:t.ariaLabel||te(e,"")}))(e,a);break;case pe.HIDDEN_FOR_READER:i={semanticType:me.UNKNOWN,textToRead:""};break;case pe.HEADING:i=((e,t)=>({semanticType:me.HEADING,textToRead:t.ariaLabel||te(e,"")}))(e,a);break;case pe.LANDMARK:i=(e=>{let t,r="";e.ariaLabel?r=e.ariaLabel:e.ariaLabelledBy&&(r=re(e.ariaLabelledBy));const{tagName:n}=e,{role:a}=e;return t="FOOTER"===n||"contentinfo"===a?me.FOOTER:"HEADER"===n||"banner"===a?me.HEADER:"FORM"===n||"form"===a?me.FORM:"MAIN"===n||"main"===a?me.MAIN:"NAV"===n||"navigation"===a?me.NAV:me.LANDMARK,{semanticType:t,textToRead:r}})(a);break;case pe.CONTROL:i=((e,t)=>{const{tagName:r,role:n,type:a,ariaLabel:o,ariaLabelledBy:i}=t;let l=!1,s="",c=me.TEXT;return"menuitem"===n||"option"===n?(s=Ee(e,t),l=!0):"link"===n||"A"===r&&!n?(c=me.LINK,s=Ee(e,t),l=!0):"button"===n||"BUTTON"===r?(c=me.BUTTON,s=Ee(e,t),l=!0):"INPUT"!==r||"button"!==a&&"submit"!==a&&"reset"!==a||(c=me.BUTTON,o?s=o:i&&(s=re(i)),l=!0),l||(s=ue(e),"checkbox"===n||"INPUT"===r&&"checkbox"===a?c=me.CHECKBOX:"radio"===n||"INPUT"===r&&"radio"===a?c=me.RADIOBUTTON:"INPUT"===r&&(c=me.INPUT),"TEXTAREA"===r&&(c=me.TEXTAREA),"SELECT"===r&&(c=me.SELECT)),{semanticType:c,textToRead:s}})(e,a);break;case pe.HAS_ALT_DESCRIPTION:i=((e,t,r)=>{const{tagName:n,role:a,ariaLabel:o}=t,i=e.getAttribute("alt")||"",l=e.getAttribute("title")||"",s=e.getAttribute("data-uw-rm-ima-original")||"";let c="",u=me.TEXT;const d=r;return"IMG"!==n&&"img"!==a||(u=me.IMAGE,d.push({name:de.SRC,value:e.src}),d.push({name:de.ORIGINAL_ALT,value:s}),c=o||i||s||c),"ABBR"===n&&(u=me.ABBR,c=l),{semanticType:u,textToRead:c,attributesToReturn:d}})(e,a,he),i.attributesToReturn&&(he=i.attributesToReturn);break;case pe.UNKNOWN:i=((e,t)=>{let r=me.TEXT;return"DIV"!==t.tagName||e.innerHTML||(r=me.LANDMARK),{semanticType:r,textToRead:""}})(e,a);break;default:i={textToRead:"",semanticType:me.TEXT}}return a.uwAtoId?l=a.uwAtoId:(l=Te,Te+=1,n.node.uwAtoId=l),__spreadValues({id:l,xpath:ae(e),label:i.textToRead.replace(/\|/g,"").trim(),tagName:a.tagName||"",type:i.semanticType,hidden:o,attributes:he,el:n.node},be)},ve=UserWayWidgetApp.getLib("accessibility_tree_walker");let Ne=[];const Re=()=>{let e=null;Ne=[];do{const t=ve.getNextAccessibilityTreeNode(e);if(!t)break;const r=_e(t.node);r&&Ne.push(r),e=t.node}while(e);Ne=Ne.map((e=>{const t=e,{el:r}=t;return __objRest(t,["el"])})),((e,t=["userway"])=>{const r=__spreadProps(__spreadValues({},e),{isUserWay:!0});t.forEach((e=>{let t=window.frames[e];if(!t||"function"!=typeof t.postMessage)try{t=document.querySelector(`iframe[name=${e}]`),t=t?t.contentWindow:null}catch(n){console.error(n)}t&&t.postMessage(r,"*")}))})({action:ge,type:"userway:ato-output:get",data:{nodes:Ne,version:Date.now()}},["uwAccessibilityEditor"])},Oe={enabled:!1},we={"userway:ato-input:enable":()=>{Oe.enabled||(Oe.enabled=!0,y(Re),Re())},"userway:ato-input:disable":()=>{var e;Oe.enabled&&(Oe.enabled=!1,e=Re,b.delete(e))},"userway:ato-input:get":Re},Le={automaticcoupons:/automaticcoupons/,"shopping.yahoo":/shopping\.yahoo/,shopperapproved:/shopperapproved/,rakuten:/rakuten/,"translate.google":/translate\.google/,"maps.googleapis.com":/maps\.googleapis\.com/,"s.w.org":/s\.w\.org/,avatar:/avatar/,companylogos:/companylogos/,favicon:/favicon/,activecampaign:/lt\.php(.*)?l=open/,aweber:/openrate\.aweber\.com/,bananatag:/bl-1\.com/,boomerang:/mailstat\.us\/tr/,"campaign monitor":/cmail(\d+)\.com\/t\//,"cirrus insight":/tracking\.cirrusinsight\.com/,close:/close\.com\/email_opened/,"constant contact":/rs6\.net\/on\.jsp/,contactmonkey:/contactmonkey\.com\/api\/v1\/tracker/,convertkit:/convertkit-mail\.com\/o/,"critical impact":/portal\.criticalimpact\.com\/c2\//,emarsys:/emarsys\.com\/e2t\/o/,gem:/zen\.sr\/o/,getnotify:/email81\.com\/case/,getresponse:/getresponse\.com\/open\.html/,growthdot:/growthdot\.com\/api\/mail-tracking/,front:/app\.frontapp\.com\/(.*)?\/seen/,hubspot:/t\.(hubspotemail|hubspotfree|signaux|senal|sidekickopen|sigopn)/,icontact:/click\.icptrack\.com\/icp/,intercom:/(via\.intercom\.io\/o)|(intercom-mail\.com\/via\/o)/,litmus:/emltrk\.com/,mailchimp:/list-manage\.com\/track/,mailgun:/email\.(mailgun|mg)(.*)?\/o/,mailjet:/mjt\.lu\/oo/,mailspring:/getmailspring\.com\/open/,mailtrack:/(mailtrack\.io\/trace)|(mltrk\.io\/pixel)/,mandrill:/mandrillapp\.com\/track/,marketo:/resources\.marketo\.com\/trk/,mixmax:/(email|track)\.mixmax\.com/,mixpanel:/api\.mixpanel\.com\/track/,nethunt:/nethunt\.co(.*)?\/pixel\.gif/,newton:/tr\.cloudmagic\.com/,outreach:/api\/mailings\/opened/,phplist:/phplist\.com\/lists\/ut\.php/,polymail:/polymail\.io/,postmark:/pstmrk\.it\/open/,"return path":/returnpath\.net\/pixel\.gif/,sailthru:/sailthru\.com\/trk/,salesforce:/nova\.collect\.igodigital\.com/,sendgrid:/wf\/open\?upn/,sendy:/sendy\/t\//,streak:/mailfoogae\.appspot\.com/,superhuman:/r\.superhuman\.com/,thunderhead:/na5\.thunderhead\.com/,tinyletter:/tinyletterapp\.com.*open\.gif/,yamm:/yamm-track\.appspot/,yesware:/t\.yesware\.com/,"zendesk sell":/futuresimple\.com\/api\/v1\/sprite\.png/},Ie=["icon","cart","logo"],Se=["h1","h2","h3","h4","h5","h6","span","a","p","figcaption","caption","div"],xe=["heading"],De=new RegExp("^(data:)"),Ce=new RegExp(/^.+\.svg$/);var Me=(e=>(e.EXCLUDED_SRC="EXCLUDED_SRC",e.HIDDEN_FROM_SCREEN_READER="HIDDEN_FROM_SCREEN_READER",e.BASE64="BASE64",e.SVG="SVG",e.SMALL_SIZE="SMALL_SIZE",e.MICRO_SIZE="MICRO_SIZE",e.WRONG_SRC="WRONG_SRC",e.ASPECT_RATIO="ASPECT_RATIO",e))(Me||{});const ke=["SVG","SMALL_SIZE","HIDDEN_FROM_SCREEN_READER"],Pe="data-uw-rm-alt-original",Ue="REMEDIATION_IMAGE_MISSING_ALT",We="data-uw-rm-alt",Be=["jpg","jpeg","png","gif","bmp","tiff","tif","svg","webp","ico","apng","heif","heic","avif","eps","raw","cr2","nef","orf","sr2"];var je=(e=>(e.CorrectAlt="ALT",e.Reverted="RT",e.Backend="BE",e.Excluded="EX",e.Hidden="HD",e.Base64="BS64",e.Svg="SVG",e.Small="SM",e.Micro="MC",e.InvalidSrc="SRC",e.AspectRatio="AR",e.AI="AI",e.AIQuotaExceed="QU",e.ClosestText="CT",e))(je||{});s.editorBuildUrl;const He=(()=>{let e=!1,t=[],r=[];const{run:n}=Y((n=>{e||(e=!0,t.forEach((e=>{e.run(n)})),e=!1,r=[])})),a=e=>{r.push(...e),n(r)};return{run:n,init:()=>__async(this,null,(function*(){const e=yield Promise.resolve().then((()=>vt));if(t=e.RulesList.filter((e=>{const t=(e=>{switch(e){case Ue:return"alt";case"aria-editor":return"ariaEditor";case"REMEDIATION_EMPTY_CONTROLS":return"emptyControls";case"REMEDIATION_FORM_LABEL":return"forms";default:return null}})(e.ruleId);if(!t||!s.paidAi)return!0;const r=i[t];return!r||r.enabled})),!l.tech_rem_on_tab){const e=h();n([...e])}const r=g(m.KeyboardNavEnabled,(()=>{const e=h();n([...e]),r()}));window.addEventListener("message",(e=>{const{data:{action:t,type:r}}=e;t===ge&&we[r]&&we[r]()})),y(a)})),onDomUpdates:a}})();(()=>{__async(this,null,(function*(){var e;yield d();const t=null!=(e=l.tech_rem_in_throttle_ms)?e:500;setTimeout((()=>{He.init(),((e=f,t=E)=>{l.tech_rem_on_tab||A.observe(e,t);const r=g(m.KeyboardNavEnabled,(()=>{A.observe(e,t),r()}))})()}),t)}))})();const Xe=({currentSrc:e,src:t})=>e||t,Fe=(e,t)=>{try{const{width:r,height:n}=window.getComputedStyle(e);return parseInt(r,10)>t&&parseInt(n,10)>t}catch(r){return!1}},$e=(e,{decorative:t,approved:r,fixedByUserWay:n,loadingFromMS:a})=>{var o;return{src:Xe(e),alt:e.alt,originalAlt:null!=(o=e.getAttribute(Pe))?o:"",decorative:t,approved:r,fixedByUserWay:n,loadingFromMS:a}},Ge=e=>{e.setAttribute("role","presentation"),e.removeAttribute("aria-hidden"),e.setAttribute("alt","")},Ke=e=>{if(!e)return"";try{const{hostname:t}=new URL(e);return t.replace(/^https?:\/\//,"").replace(/^www\./,"").replace(/\.[a-zA-Z0-9]*$/,"")}catch(t){return""}},Ve=(e,t)=>{if(!t)return!1;const r=Xe(e);return Ke(r)!==t&&!Fe(e,10)},Ze=e=>{const t=new RegExp(`\\.(${Be.join("|")})$`,"i").test(e),r=e.length>255,n=!e.trim(),a=/[0-9]{5,}/.test(e),o=new RegExp(/^[!@#$%^&*()_+{}[\]`:;<>,.?~\\|\-="'/]+$/,"u").test(e);return a||t||r||n||o},qe=(e,t)=>{const r=t.alt.trim(),n=Xe(t),a=e.find((e=>se(e.src)===se(n)));if(!a||null===a.alt)return null;const{decorative:o,alt:l,approved:s,reverted:c}=a;if(c)return t.setAttribute(We,je.Reverted),$e(t,{approved:!0,decorative:!r,fixedByUserWay:!1});const u=!(!i||"AUTO"===i.strategy)&&!s;o&&!u&&Ge(t);const d=s||!r||Ze(r);l&&!u&&d&&!o&&t.setAttribute("alt",l),t.setAttribute(We,je.Backend);const p=$e(t,{approved:s,decorative:o,fixedByUserWay:!0});return u&&(p.alt=l),p},ze=e=>{const t=Xe(e),r=Ze(e.alt);var n;if(!(n=t)||!n.match(De)&&!new RegExp("^https?://.{1,256}\\.[a-z]{2,6}/.+$","i").test(n))return Me.WRONG_SRC;const a=(e=>{if("string"!=typeof e)return!1;for(const t of Object.values(Le)){const r=new RegExp(t,"i");if(e.match(r))return!0}return!1})(t);if(a)return Me.EXCLUDED_SRC;if(!Fe(e,5))return Me.MICRO_SIZE;if((e=>{try{const{width:t,height:r}=window.getComputedStyle(e),n=parseInt(t,10),a=parseInt(r,10);return!!(n<=10&&a>=10*n||a<=10&&n>=10*a)}catch(t){return!1}})(e))return Me.ASPECT_RATIO;if(De.test(t))return Me.BASE64;if("true"===e.getAttribute("aria-hidden")||"presentation"===e.getAttribute("role")||"none"===e.getAttribute("role"))return Me.HIDDEN_FROM_SCREEN_READER;if(Ce.test(t)&&r)return Me.SVG;return!Fe(e,50)&&r?Me.SMALL_SIZE:null},Ye=e=>{switch(e){case Me.ASPECT_RATIO:return je.AspectRatio;case Me.BASE64:return je.Base64;case Me.EXCLUDED_SRC:return je.Excluded;case Me.SVG:return je.Svg;case Me.MICRO_SIZE:return je.Micro;case Me.SMALL_SIZE:return je.Small;case Me.WRONG_SRC:return je.InvalidSrc;case Me.HIDDEN_FROM_SCREEN_READER:default:return je.Hidden}};let Qe={};const Je=(e,t)=>{const r=ae(e);Qe[r]=t},et=e=>{const t=ae(e);return Qe[t]||null},tt=e=>((e,t,r,n)=>{const a=UserWayWidgetApp.getLib("remediation_manager"),o=UserWayWidgetApp.getLib("remediation_helper_outcome");if(!o.of)return;const i=o.of(e,{items:t},null,r,n);a.HelperCallbackAggregator.onHelperRemediationCompleted(i)})(Ue,e,e.filter((e=>e.fixedByUserWay)).length,e.filter((e=>!e.approved)).length),rt=e=>{e.hasAttribute(Pe)||e.setAttribute(Pe,e.alt)},nt=(e,t=[])=>{var r,n;if(0===e.length)return;const{paidAi:a}=s,o=[];for(const l of e){const e=l,s=Ze(e.alt),u=Xe(e);rt(e),Ce.test(u)&&a&&e.setAttribute("role","img");const d=qe(t,e);if(d){o.push(d);continue}if(!a)continue;const p=ze(e);if(!s&&!p){e.setAttribute(We,je.CorrectAlt),o.push($e(e,{approved:!0,decorative:!1,fixedByUserWay:!1}));continue}if(null!==p||(null==(n=null==(r=i.alt)?void 0:r.config)?void 0:n.quotaExceeded)){Ge(e),e.setAttribute(We,Ye(p)),p&&ke.includes(p)&&o.push($e(e,{approved:!1,decorative:!0,fixedByUserWay:!0}));continue}const m=et(e);if(m){e.setAttribute("alt",m),e.setAttribute(We,je.ClosestText),o.push($e(e,{approved:!1,decorative:!1,fixedByUserWay:!0}));continue}const{quota:g,usage:f}=c;f>=g?(e.setAttribute(We,je.AIQuotaExceed),o.push($e(e,{approved:!1,decorative:!1,fixedByUserWay:!1}))):(e.setAttribute(We,je.AI),o.push($e(e,{approved:!1,decorative:!1,fixedByUserWay:!0,loadingFromMS:!0})))}tt(o)},at=e=>{const t=e.replace(/^https?:\/\//,"");return document.querySelectorAll(`img[src*="${t}" i],img[srcset*="${t}" i]`)},ot=e=>__async(this,null,(function*(){const{account:t}=UserWayWidgetApp.ContextHolder.config,{siteId:r}=s,{resourceHash:n}=c,a=encodeURIComponent(e),o=yield fetch(`https://cdn.userway.org/api/img-dscr/v2/${t}/${r}/${n}/alts.json?dto=${a}`,{method:"GET",headers:{"Content-Type":"application/json"}});return(yield o.json()).payload})),it=e=>{const t=`(.*\\.(${Be.join("|")}))\\?.*$`,r=new RegExp(t),n=e.match(r);return n&&n[1]?n[1].toLowerCase():e};var lt=(e=>(e.RO="RO",e))(lt||{});const st=e=>e?e.replace(/\n/g,"").replace(/ {2,}/g," ").trim():"",ct=(e,t)=>{if(!e)return null;const r="next"===t.type?e.nextSibling:e.previousSibling;if((null==r?void 0:r.nodeType)===Node.TEXT_NODE){if(!st(r.nodeValue))return ct(r,{type:t.type})}return r},ut=e=>{const t=e.nodeType===Node.ELEMENT_NODE;if(e.nodeType===Node.TEXT_NODE)return!0;if(t){const t=Se.some((t=>t===e.nodeName.toLowerCase())),r=xe.some((t=>{var r;return t===(null==(r=e.getAttribute("role"))?void 0:r.toLowerCase())}));return t||r}return!1},dt=Array.from(new Set([...Se,"a","span","strong","em","b","i","q","mark"])),pt=e=>{if((null==e?void 0:e.nodeType)===Node.TEXT_NODE){const t=st(e.nodeValue);if(t&&!Ze(t))return t}if((null==e?void 0:e.nodeType)===Node.ELEMENT_NODE&&dt.includes(e.tagName.toLowerCase()))for(const t of e.childNodes){const e=pt(t);if(e)return e}return null},mt=e=>{const t=e.nodeType===Node.ELEMENT_NODE,r=e.nodeType===Node.TEXT_NODE;if(!r&&!t)return!1;if(t&&"img"===e.nodeName.toLowerCase())return!0;if(r)return!!st(e.textContent);const n=Se.some((t=>t===e.nodeName.toLowerCase())),a=xe.some((t=>{var r;return t===(null==(r=e.getAttribute("role"))?void 0:r.toLowerCase())}));return n||a};let gt=0;const ft=e=>{const t=e.parentElement;if(!t)return null;if(t.getElementsByTagName("img").length>1)return gt=0,null;if(1===[].slice.call(t.childNodes).filter(mt).length)return ft(t);const r=(e=>{let t=ct(e,{type:"next"}),r=ct(e,{type:"prev"}),n=null,a=null;for(;t||r;){t&&ut(t)&&(n=pt(t)),r&&ut(r)&&(a=pt(r));const e=n||a;if(e)return e;t=ct(t,{type:"next"}),r=ct(r,{type:"prev"})}return null})(e);return r?(gt=0,r):(gt+=1,"body"===t.tagName.toLowerCase()?(gt=0,null):gt<2?ft(t):(gt=0,null))},Et=e=>{const t=e.closest("figure");if(t){const e=Array.from(t.children).find((e=>"figcaption"===e.tagName.toLowerCase()));if(e){const t=st(e.textContent);if(t&&!Ze(t))return t}}const r=[].slice.call(e.classList).join(" "),n=e.id||"",a=(o=r+n).trim()&&Ie.find((e=>o.includes(e)))||null;var o;if(a)return a;const i=ft(e);return i||null},bt=(e,t)=>e.src.localeCompare(t.src),yt=(e,t=1)=>{if(t>=15)return console.warn("Max split level exceed"),[];const r=((e,t)=>{const r=Math.ceil(e.length/t),n=[];for(let a=0;a<e.length;a+=r)n.push(e.slice(a,a+r));return n})(e,t),n=[];for(const a of r){const r={sorted:a,tier:c.tier},o=JSON.stringify(r);if(encodeURIComponent(o).length/1024>8)return yt(e,t+1);n.push(o)}return n},At=[],ht=e=>{if(!c)return;const{state:t}=c;if("ALTS_OFF"===t)return;const r=(e=>{var t,r;const n=[];for(const a of e){const e=Xe(a),t=Ke(e);if(t){let e=n.find((e=>e.name===t));e||(e={name:t,weight:0},n.push(e)),e.weight+=1}}return null!=(r=null==(t=n.sort(((e,t)=>e.weight<t.weight?1:-1))[0])?void 0:t.name)?r:""})(e),n=[],a=[];for(const i of e){const e=i,t=Ve(e,r),o=ze(e),l=o&&!ke.includes(o)||t;let s=null;l||(s=Et(e)),l?a.push(e):s?(Je(e,s),a.push(e)):n.push(e)}try{const e=(e=>{const t=e,r=t.filter(((e,r)=>r===t.findIndex((t=>Xe(e)===Xe(t))))).map((e=>{const t=e,r=t.alt.trim(),n=r&&!Ze(r),a=Xe(t);return{src:it(a),alt:t.alt.trim(),dir:n||ze(t)||Et(t)?lt.RO:void 0}}));return r.sort(bt),r})(n),t=yt(e);if(t.length)for(const r of t)ot(r).then((({missingAlts:e})=>{const t=n.filter((t=>e.find((e=>se(e.src)===se(Xe(t))))));nt(t,e)}))}catch(o){console.error(o)}nt(a),At.length=0,Qe={}},Tt=q((e=>ht(e)),1e3,{maxWait:2e3,leading:!0,trailing:!0}),_t=[(({ruleId:e,isTargetElement:t,rule:r,postMessageApi:n,forceRun:a})=>(n&&window.addEventListener("message",(e=>{const{data:t}=e,{isUserWay:r,action:a,type:o}=t;!r||a!==p.Remediation&&a!==p.AriaEditor||n[o]&&n[o](t.data?t.data:t)})),{run:n=>{if(!t)return void r({context:{elements:n}});const o=n.filter((r=>!r.hasAttribute(`uw-ignore-${e}`)&&t(r)));o.length?r({context:{elements:o}}):a&&r({context:{elements:[]}})},stop:()=>{},rerun:()=>{},ruleId:e}))({ruleId:Ue,rule:({context:{elements:e}})=>{At.push(...e),Tt(At)},isTargetElement:e=>{const t="img"===e.tagName.toLowerCase(),r=e.hasAttribute(We);if(!t||r)return!1;const n=e.getAttribute("src"),a=e.getAttribute("srcset");return!!(null!=n?n:a)||!!e.closest("picture")},postMessageApi:{"image-alt-update":({src:e,decorative:t,alt:r,role:n})=>{const a=at(e);if(a.length){for(const e of a)e.setAttribute("alt",null!=r?r:""),t?Ge(e):("presentation"!==e.getAttribute("role")&&"none"!==e.getAttribute("role")||e.removeAttribute("role"),e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden")),["link","button","heading"].includes(n)&&e.setAttribute("aria-label",r);tt([$e(a[0],{approved:!0,decorative:t,fixedByUserWay:!1})])}},"image-alt-revert":({src:e})=>{const t=at(e);for(const r of t){const e=r.getAttribute(Pe);null!==e&&r.setAttribute("alt",e)}},"image-alt-update-config":()=>{d()}}})],vt=Object.freeze(Object.defineProperty({__proto__:null,RulesList:_t},Symbol.toStringTag,{value:"Module"}))}();
//# sourceMappingURL=remediation-tool-free.js.map
